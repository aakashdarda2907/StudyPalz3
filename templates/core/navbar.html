{% load static %}

<style>
    /* Google Fonts */
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap');

    :root {
        --primary-teal: #06b6d4;
        --primary-teal-dark: #0891b2;
        --accent-gradient: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
        --white: #ffffff;
        --dark-blue: #0f172a;
        --medium-blue: #334155;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    /* Applies a top margin to the main content of the page to prevent it from being hidden behind the fixed navbar */
    body {
        padding-top: 120px;
    }

    .header {
        background: rgba(255, 255, 255, 0.85);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        padding: 1rem 0;
        position: fixed;
        top: 1.5rem;
        left: 50%;
        transform: translateX(-50%);
        width: calc(100% - 4rem);
        max-width: 1200px;
        z-index: 1000;
        border: 1px solid rgba(255, 255, 255, 0.3);
        border-radius: 24px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        transition: var(--transition);
        font-family: 'Inter', sans-serif;
    }

    .header .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 2rem;
        margin: 0 auto;
    }

    .logo {
        font-family: 'Plus Jakarta Sans', sans-serif;
        font-size: 1.8rem;
        font-weight: 800;
        background: var(--accent-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-decoration: none;
        transition: var(--transition);
    }
    .logo:hover { transform: scale(1.05); }

    .nav-wrapper { display: flex; align-items: center; gap: 2.5rem; flex: 1; justify-content: center; }
    .nav-links-container { display: flex; gap: 1.5rem; align-items: center; }
    .nav-link { color: var(--medium-blue); text-decoration: none; font-weight: 500; font-size: 1rem; transition: var(--transition); padding: 0.7rem 1.2rem; border-radius: 14px; }
    .nav-link:hover { color: var(--primary-teal); background: rgba(6, 182, 212, 0.08); }
    .nav-link.active { color: var(--primary-teal-dark); background: rgba(6, 182, 212, 0.12); font-weight: 600; }
    
    .auth-buttons { display: flex; gap: 1rem; }
    .btn { display: inline-flex; align-items: center; justify-content: center; padding: 0.7rem 1.6rem; border-radius: 16px; text-decoration: none; font-weight: 600; font-size: 0.9rem; transition: var(--transition); border: none; cursor: pointer; font-family: 'Plus Jakarta Sans', sans-serif; }
    .btn-primary { background: var(--accent-gradient); color: var(--white); box-shadow: 0 4px 16px rgba(6, 182, 212, 0.3); }
    .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4); }
    .btn-secondary { background: rgba(6, 182, 212, 0.08); border: 1px solid rgba(6, 182, 212, 0.25); color: var(--primary-teal); }
    .btn-secondary:hover { background: rgba(6, 182, 212, 0.15); border-color: rgba(6, 182, 212, 0.4); }

    .mobile-menu-toggle { display: none; }
    .mobile-nav-backdrop { display: none; }
    .mobile-nav-sheet { display: none; }

    /* Responsive Design for Navbar */
    @media (max-width: 1024px) {
        .nav-links-container { display: none; }
        .mobile-menu-toggle { display: flex; background: rgba(6, 182, 212, 0.08); border: 1px solid rgba(6, 182, 212, 0.2); font-size: 1.2rem; color: var(--primary-teal); cursor: pointer; padding: 0.8rem 1rem; border-radius: 14px; width: 48px; height: 48px; align-items: center; justify-content: center; }
        .auth-buttons { display: none; }
        
        .mobile-nav-backdrop { display: block; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); backdrop-filter: blur(4px); z-index: 1998; opacity: 0; visibility: hidden; transition: all 0.3s ease; }
        .mobile-nav-backdrop.active { opacity: 1; visibility: visible; }
        
        .mobile-nav-sheet { display: block; position: fixed; bottom: 0; left: 0; right: 0; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(30px); border-radius: 24px 24px 0 0; box-shadow: 0 -20px 40px rgba(0,0,0,0.15); border: 1px solid rgba(255,255,255,0.3); transform: translateY(100%); transition: transform 0.4s ease; z-index: 1999; }
        .mobile-nav-sheet.active { transform: translateY(0); }
        .sheet-handle { width: 50px; height: 4px; background: rgba(6, 182, 212, 0.3); border-radius: 2px; margin: 1rem auto 0; }
        .sheet-content { padding: 1.5rem 2rem 2rem; }
        .sheet-title { font-family: 'Plus Jakarta Sans', sans-serif; font-size: 1.5rem; text-align: center; margin-bottom: 2rem; background: var(--accent-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .mobile-nav-links { display: grid; gap: 0.8rem; }
        .mobile-nav-links .nav-link { background: rgba(6, 182, 212, 0.04); border: 1px solid rgba(6, 182, 212, 0.08); justify-content: space-between; }
        .mobile-account-section { margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid var(--border-light); }
        .mobile-account-buttons { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
    }
</style>

<nav class="header" id="navbar">
    <div class="container">
        <a href="{% if user.is_authenticated %}{% url 'dashboard' %}{% else %}{% url 'home' %}{% endif %}" class="logo">StudyPalz</a>
        
        <div class="nav-wrapper">
            <div class="nav-links-container">
                <a href="{% url 'dashboard' %}" class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">Dashboard</a>
                <a href="{% url 'revision_hub' %}" class="nav-link {% if request.resolver_match.url_name == 'revision_hub' %}active{% endif %}">Revision Hub</a>
                </div>
        </div>

        <div class="auth-buttons">
            {% if user.is_authenticated %}
                <a href="{% url 'logout' %}" class="btn btn-secondary">Log Out</a>
            {% else %}
                <a href="{% url 'login' %}" class="btn btn-secondary">Log In</a>
                <a href="{% url 'signup' %}" class="btn btn-primary">Sign Up</a>
            {% endif %}
        </div>

        <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="Toggle navigation menu">☰</button>
    </div>
</nav>

<div class="mobile-nav-backdrop" id="mobileNavBackdrop"></div>
<div class="mobile-nav-sheet" id="mobileNavSheet">
    <div class="sheet-handle"></div>
    <div class="sheet-content">
        <h2 class="sheet-title">Menu</h2>
        <div class="mobile-nav-links">
            <a href="{% url 'dashboard' %}" class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">Dashboard</a>
            <a href="{% url 'revision_hub' %}" class="nav-link {% if request.resolver_match.url_name == 'revision_hub' %}active{% endif %}">Revision Hub</a>
        </div>
        <div class="mobile-account-section">
            <div class="mobile-account-buttons">
                {% if user.is_authenticated %}
                    <a href="{% url 'logout' %}" class="btn btn-secondary">Log Out</a>
                {% else %}
                    <a href="{% url 'login' %}" class="btn btn-secondary">Log In</a>
                    <a href="{% url 'signup' %}" class="btn btn-primary">Sign Up</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<script>
    const mobileMenuToggle = document.getElementById('mobileMenuToggle');
    const mobileNavSheet = document.getElementById('mobileNavSheet');
    const mobileNavBackdrop = document.getElementById('mobileNavBackdrop');
    let isNavOpen = false;

    function openMobileNav() {
        if (isNavOpen) return;
        isNavOpen = true;
        mobileNavSheet.classList.add('active');
        mobileNavBackdrop.classList.add('active');
        mobileMenuToggle.innerHTML = '✕';
        document.body.style.overflow = 'hidden';
    }

    function closeMobileNav() {
        if (!isNavOpen) return;
        isNavOpen = false;
        mobileNavSheet.classList.remove('active');
        mobileNavBackdrop.classList.remove('active');
        mobileMenuToggle.innerHTML = '☰';
        document.body.style.overflow = '';
    }

    mobileMenuToggle.addEventListener('click', () => {
        isNavOpen ? closeMobileNav() : openMobileNav();
    });

    mobileNavBackdrop.addEventListener('click', closeMobileNav);
</script>